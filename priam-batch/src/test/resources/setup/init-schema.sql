-- Habib Benmerzouka

DROP TABLE IF EXISTS PRIAM_LIGNE_PROGRAMME;
DROP TABLE IF EXISTS PRIAM_FICHIER;
DROP TABLE IF EXISTS PRIAM_STATUT;
DROP TABLE IF EXISTS PRIAM_LIBFAMITYPUTIL;
DROP TABLE IF EXISTS PRIAM_LIBTYPUTIL;
DROP TABLE IF EXISTS PRIAM_TYPUTIL;

DROP TABLE IF EXISTS PRIAM_FAMILTYPUTIL;

CREATE TABLE PRIAM_STATUT (
  CODE        VARCHAR(255) NOT NULL,
  LIBELLE     VARCHAR(255),
  DESCRIPTION VARCHAR(255),
  PRIMARY KEY (CODE)
);

CREATE TABLE PRIAM_LIBFAMITYPUTIL (

  CODE    VARCHAR(255) NOT NULL,
  LIBELLE VARCHAR(255),
  CDELNG  VARCHAR(2),


  PRIMARY KEY (CODE, CDELNG)

);

CREATE TABLE PRIAM_LIBTYPUTIL (

  CODE    VARCHAR(255) NOT NULL,
  CDELNG  VARCHAR(2),
  LIBELLE VARCHAR(255),

  PRIMARY KEY (CODE, CDELNG)

);
-- -------------------------------
-- Table PRIAM_FAMILTYPUTIL
-- ------------------------------
CREATE TABLE PRIAM_FAMILTYPUTIL (
  CDEFAMILTYPUTIL VARCHAR(10) NOT NULL,
  DATDBTVLD       DATE        NOT NULL,
  DATFINVLD       DATE,

  CONSTRAINT PRIAM_FAMILTYPUTIL_PK PRIMARY KEY (CDEFAMILTYPUTIL)
);

-- -------------------------------
-- Table PRIAM_TYPUTIL
-- ------------------------------
CREATE TABLE PRIAM_TYPUTIL (
  CDETYPUTIL      VARCHAR(10) NOT NULL,
  CDEFAMILTYPUTIL VARCHAR(10) NOT NULL,
  DATDBTVLD       DATE        NOT NULL,
  DATFINVLD       DATE,

  CONSTRAINT PRIAM_TYPUTIL_PK PRIMARY KEY (CDETYPUTIL),
  CONSTRAINT PRIAM_TYPUT_TYPUTILFAMILL_FK FOREIGN KEY (CDEFAMILTYPUTIL) REFERENCES PRIAM_FAMILTYPUTIL (CDEFAMILTYPUTIL)
);

CREATE TABLE PRIAM_FICHIER (
  ID              BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  NOM             VARCHAR(255) DEFAULT NULL,
  CDEFAMILTYPUTIL VARCHAR(10),
  CDETYPUTIL      VARCHAR(10),
  DATE_DEBUT_CHGT DATETIME,
  DATE_FIN_CHGT   DATETIME,
  NB_LIGNES       BIGINT,
  STATUT_CODE     VARCHAR(255),

  -- CONSTRAINT FK_STATUT FOREIGN KEY (STATUT_CODE) REFERENCES PRIAM_STATUT(CODE),
  CONSTRAINT FK_FAMILLE FOREIGN KEY (CDEFAMILTYPUTIL) REFERENCES PRIAM_FAMILTYPUTIL (CDEFAMILTYPUTIL),
  CONSTRAINT FK_TYPE_UTIL FOREIGN KEY (CDETYPUTIL) REFERENCES PRIAM_TYPUTIL (CDETYPUTIL),
  PRIMARY KEY (ID)
);


CREATE TABLE PRIAM_LIGNE_PROGRAMME
(
  id              INT          NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  cdeCisac        VARCHAR(3)   NULL,
  cdeTer          BIGINT       NULL,
  rionEffet       INT          NULL,
  cdeFamilTypUtil VARCHAR(45)  NULL,
  cdeModFac       VARCHAR(45)  NULL,
  numProg         INT          NULL,
  keyLigPenel     INT          NULL,
  cdeUtil         VARCHAR(45)  NULL,
  cdeTypUtil      VARCHAR(45)  NULL,
  cdeTypProg      VARCHAR(45)  NULL,
  cdeCompl        VARCHAR(45)  NULL,
  libProg         VARCHAR(100) NULL,
  compLibProg     VARCHAR(100) NULL,
  datDbtProg      DATETIME     NULL,
  datFinProg      DATETIME     NULL,
  hrDbt           INT          NULL,
  hrFin           INT          NULL,
  cdeGreDif       VARCHAR(45)  NULL,
  cdeModDif       VARCHAR(45)  NULL,
  cdeTypIde12     VARCHAR(45)  NULL,
  ide12           BIGINT       NULL,
  datDif          DATETIME     NULL,
  hrDif           INT          NULL,
  durDif          INT          NULL,
  nbrDif          INT          NULL,
  mt              DOUBLE       NULL,
  ctna            VARCHAR(45)  NULL,
  paramCoefHor    VARCHAR(10)  NULL,
  durDifCtna      INT          NULL,
  cdeLng          VARCHAR(45)  NULL,
  indDoubSsTit    VARCHAR(45)  NULL,
  tax             DOUBLE       NULL,
  typMt           VARCHAR(45)  NULL,
  ID_FICHIER      BIGINT       NOT NULL,
  CONSTRAINT FK_ID_FICHIER
  FOREIGN KEY (ID_FICHIER) REFERENCES PRIAM_FICHIER (ID)
);

